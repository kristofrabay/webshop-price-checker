scale_x_continuous(breaks = c(0, 1)) +
scale_y_continuous(labels = percent, breaks = seq(0, 1.1, 0.1)) +
facet_wrap(~product_main_categories) +
labs(title = paste0('Akciós termékek aránya ', Sys.Date()),
x = NULL, y = NULL) +
theme_bw()
data %>% group_by(product_main_categories, sale_flag) %>% summarize(count = n()) %>% mutate(sale_flag = ifelse(is.na(sale_flag), 0, 1), count_pct = count / sum(count)) %>%
ggplot(aes(sale_flag, count_pct)) +
geom_col() +
geom_text(aes(label = scales::percent(count_pct)), position = position_dodge(width = 1.5), vjust = -1/3) +
scale_x_continuous(breaks = c(0, 1)) +
scale_y_continuous(labels = percent, breaks = seq(0, 1, 0.1), limits = c(0, 1)) +
facet_wrap(~product_main_categories) +
labs(title = paste0('Akciós termékek aránya ', Sys.Date()),
x = NULL, y = NULL) +
theme_bw()
data %>% group_by(product_main_categories, sale_flag) %>% summarize(count = n()) %>% mutate(sale_flag = ifelse(is.na(sale_flag), 0, 1), count_pct = count / sum(count)) %>%
ggplot(aes(sale_flag, count_pct)) +
geom_col() +
geom_text(aes(label = scales::percent(count_pct)), position = position_dodge(width = 1.5), vjust = -1/3) +
scale_x_continuous(breaks = c(0, 1)) +
scale_y_continuous(labels = percent_format(accuracy = 5L), breaks = seq(0, 1, 0.1), limits = c(0, 1)) +
facet_wrap(~product_main_categories) +
labs(title = paste0('Akciós termékek aránya ', Sys.Date()),
x = NULL, y = NULL) +
theme_bw()
data %>% group_by(product_main_categories, sale_flag) %>% summarize(count = n()) %>% mutate(sale_flag = ifelse(is.na(sale_flag), 0, 1), count_pct = count / sum(count)) %>%
ggplot(aes(sale_flag, count_pct)) +
geom_col() +
geom_text(aes(label = scales::percent_format(count_pct, accuracy = 5L)), position = position_dodge(width = 1.5), vjust = -1/3) +
scale_x_continuous(breaks = c(0, 1)) +
scale_y_continuous(labels = percent_format(accuracy = 5L), breaks = seq(0, 1, 0.1), limits = c(0, 1)) +
facet_wrap(~product_main_categories) +
labs(title = paste0('Akciós termékek aránya ', Sys.Date()),
x = NULL, y = NULL) +
theme_bw()
data %>% group_by(product_main_categories, sale_flag) %>% summarize(count = n()) %>% mutate(sale_flag = ifelse(is.na(sale_flag), 0, 1), count_pct = count / sum(count)) %>%
ggplot(aes(sale_flag, count_pct)) +
geom_col() +
geom_text(aes(label = scales::percent(round(count_pct))), position = position_dodge(width = 1.5), vjust = -1/3) +
scale_x_continuous(breaks = c(0, 1)) +
scale_y_continuous(labels = percent_format(accuracy = 5L), breaks = seq(0, 1, 0.1), limits = c(0, 1)) +
facet_wrap(~product_main_categories) +
labs(title = paste0('Akciós termékek aránya ', Sys.Date()),
x = NULL, y = NULL) +
theme_bw()
data %>% group_by(product_main_categories, sale_flag) %>% summarize(count = n()) %>% mutate(sale_flag = ifelse(is.na(sale_flag), 0, 1), count_pct = count / sum(count)) %>%
ggplot(aes(sale_flag, count_pct)) +
geom_col() +
geom_text(aes(label = scales::percent(round(count_pct, digits = 1))), position = position_dodge(width = 1.5), vjust = -1/3) +
scale_x_continuous(breaks = c(0, 1)) +
scale_y_continuous(labels = percent_format(accuracy = 5L), breaks = seq(0, 1, 0.1), limits = c(0, 1)) +
facet_wrap(~product_main_categories) +
labs(title = paste0('Akciós termékek aránya ', Sys.Date()),
x = NULL, y = NULL) +
theme_bw()
data %>% group_by(product_main_categories, sale_flag) %>% summarize(count = n()) %>% mutate(sale_flag = ifelse(is.na(sale_flag), 0, 1), count_pct = count / sum(count)) %>%
ggplot(aes(sale_flag, count_pct)) +
geom_col() +
geom_text(aes(label = scales::percent(round(count_pct, digits = 2))), position = position_dodge(width = 1.5), vjust = -1/3) +
scale_x_continuous(breaks = c(0, 1)) +
scale_y_continuous(labels = percent_format(accuracy = 5L), breaks = seq(0, 1, 0.1), limits = c(0, 1)) +
facet_wrap(~product_main_categories) +
labs(title = paste0('Akciós termékek aránya ', Sys.Date()),
x = NULL, y = NULL) +
theme_bw()
data %>% group_by(product_main_categories, sale_flag) %>% summarize(count = n()) %>% mutate(sale_flag = ifelse(is.na(sale_flag), 0, 1), count_pct = count / sum(count)) %>%
ggplot(aes(sale_flag, count_pct)) +
geom_col() +
geom_text(aes(label = scales::percent(round(count_pct, digits = 3))), position = position_dodge(width = 1.5), vjust = -1/3) +
scale_x_continuous(breaks = c(0, 1)) +
scale_y_continuous(labels = percent_format(accuracy = 5L), breaks = seq(0, 1, 0.1), limits = c(0, 1)) +
facet_wrap(~product_main_categories) +
labs(title = paste0('Akciós termékek aránya ', Sys.Date()),
x = NULL, y = NULL) +
theme_bw()
data %>% group_by(sale_flag) %>% summarize(count = n()) %>% mutate(sale_flag = ifelse(is.na(sale_flag), 0, 1), count_pct = count / sum(count)) %>%
ggplot(aes(sale_flag, count)) +
geom_col() +
geom_text(aes(label = scales::percent(count_pct)), position = position_dodge(width = 1), vjust = -0.5) +
scale_x_continuous(breaks = c(0, 1)) +
labs(title = paste0('Akciós termékek aránya ', Sys.Date()),
x = NULL, y = NULL) +
theme_bw()
data %>% group_by(sale_flag) %>% summarize(count = n()) %>% mutate(sale_flag = ifelse(is.na(sale_flag), 0, 1), count_pct = count / sum(count)) %>%
ggplot(aes(sale_flag, count)) +
geom_col() +
geom_text(aes(label = scales::percent(count_pct)), position = position_dodge(width = 1), vjust = -0.5) +
scale_x_continuous(breaks = c(0, 1)) +
scale_y_continuous() +
labs(title = paste0('Akciós termékek aránya ', Sys.Date()),
x = 'Akciós', y = 'Db') +
theme_bw()
dir.create(paste0("charts/", Sys.Date()))
data %>% group_by(sale_flag) %>% summarize(count = n()) %>% mutate(sale_flag = ifelse(is.na(sale_flag), 0, 1), count_pct = count / sum(count)) %>%
ggplot(aes(sale_flag, count)) +
geom_col() +
geom_text(aes(label = scales::percent(count_pct)), position = position_dodge(width = 1), vjust = -0.5) +
scale_x_continuous(breaks = c(0, 1)) +
scale_y_continuous() +
labs(title = paste0('Akciós termékek aránya ', Sys.Date()),
x = 'Akciós', y = 'Db') +
theme_bw()
ggsave(paste0("charts/", Sys.Date(), "/on_sale.png"))
data %>% group_by(product_main_categories, sale_flag) %>% summarize(count = n()) %>% mutate(sale_flag = ifelse(is.na(sale_flag), 0, 1), count_pct = count / sum(count)) %>%
ggplot(aes(sale_flag, count_pct)) +
geom_col() +
geom_text(aes(label = scales::percent(round(count_pct, digits = 3))), position = position_dodge(width = 1.5), vjust = -1/3) +
scale_x_continuous(breaks = c(0, 1)) +
scale_y_continuous(labels = percent_format(accuracy = 5L), breaks = seq(0, 1, 0.1), limits = c(0, 1)) +
facet_wrap(~product_main_categories) +
labs(title = paste0('Akciós termékek aránya ', Sys.Date()),
x = NULL, y = NULL) +
theme_bw()
ggsave(paste0("charts/", Sys.Date(), "/on_sale_by_cat.png"))
data %>% ggplot(aes(abs(sale_rel))) +
geom_histogram(binwidth = 0.01) +
facet_wrap(~product_main_categories, scales = 'free_y') +
theme_bw()
data %>% ggplot(aes(product_main_categories, abs(sale_rel))) +
geom_boxplot() +
theme_bw()
data %>% ggplot(aes(product_main_categories, abs(sale_rel))) +
geom_boxplot() +
labs(x = NULL, y = '%', title = paste0('Akciók eloszlása ', Sys.Date())) +
theme_bw()
data %>% ggplot(aes(product_main_categories, abs(sale_rel))) +
geom_boxplot() +
labs(x = NULL, y = '%', title = paste0('Akciók eloszlása ', Sys.Date())) +
scale_y_continuous(labels = percent_format(accuracy = 5L), breaks = seq(0, 1, 0.1), limits = c(0, 1)) +
theme_bw()
data %>% ggplot(aes(product_main_categories, abs(sale_rel))) +
geom_boxplot() +
labs(x = NULL, y = NULL, title = paste0('Akciók eloszlása ', Sys.Date())) +
scale_y_continuous(labels = percent_format(accuracy = 5L), breaks = seq(0, 1, 0.1), limits = c(0, 1)) +
theme_bw()
data %>% ggplot(aes(product_main_categories, abs(sale_rel))) +
geom_boxplot() +
labs(x = NULL, y = NULL, title = paste0('Akciók eloszlása ', Sys.Date())) +
scale_y_continuous(labels = percent_format(accuracy = 5L), breaks = seq(0, 1, 0.1), limits = c(0, 1)) +
theme_bw() +
theme(axis.text.x = element_text(angle = 95, vjust = 0.5, hjust=1))
data %>% ggplot(aes(product_main_categories, abs(sale_rel))) +
geom_boxplot() +
labs(x = NULL, y = NULL, title = paste0('Akciók eloszlása ', Sys.Date())) +
scale_y_continuous(labels = percent_format(accuracy = 5L), breaks = seq(0, 1, 0.1), limits = c(0, 1)) +
theme_bw() +
theme(axis.text.x = element_text(angle = 45, vjust = 0.5, hjust=1))
data %>% ggplot(aes(product_main_categories, abs(sale_rel))) +
geom_boxplot() +
labs(x = NULL, y = NULL, title = paste0('Akciók eloszlása ', Sys.Date())) +
scale_y_continuous(labels = percent_format(accuracy = 5L), breaks = seq(0, 1, 0.1), limits = c(0, 1)) +
theme_bw() +
theme(axis.text.x = element_text(angle = 45, vjust = 0, hjust=1))
data %>% ggplot(aes(product_main_categories, abs(sale_rel))) +
geom_boxplot() +
labs(x = NULL, y = NULL, title = paste0('Akciók eloszlása ', Sys.Date())) +
scale_y_continuous(labels = percent_format(accuracy = 5L), breaks = seq(0, 1, 0.1), limits = c(0, 1)) +
theme_bw() +
theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust=1))
data %>% ggplot(aes(product_main_categories, abs(sale_rel), color = product_main_categories, fill = product_main_categories)) +
geom_boxplot(alpha = 0.5) +
labs(x = NULL, y = NULL, title = paste0('Akciók eloszlása ', Sys.Date())) +
scale_y_continuous(labels = percent_format(accuracy = 5L), breaks = seq(0, 1, 0.1), limits = c(0, 1)) +
theme_bw() +
theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust=1))
data %>% ggplot(aes(product_main_categories, abs(sale_rel), color = product_main_categories, fill = product_main_categories)) +
geom_boxplot(alpha = 0.5, show.legend = F) +
labs(x = NULL, y = NULL, title = paste0('Akciók eloszlása ', Sys.Date())) +
scale_y_continuous(labels = percent_format(accuracy = 5L), breaks = seq(0, 1, 0.1), limits = c(0, 1)) +
theme_bw() +
theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust=1))
data %>% ggplot(aes(product_main_categories, abs(sale_rel), color = product_main_categories, fill = product_main_categories)) +
geom_boxplot(alpha = 0.5, show.legend = F, notch = T) +
labs(x = NULL, y = NULL, title = paste0('Akciók eloszlása ', Sys.Date())) +
scale_y_continuous(labels = percent_format(accuracy = 5L), breaks = seq(0, 1, 0.1), limits = c(0, 1)) +
theme_bw() +
theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust=1))
data %>% ggplot(aes(product_main_categories, abs(sale_rel), color = product_main_categories, fill = product_main_categories)) +
geom_boxplot(alpha = 0.5, show.legend = F, varwidth = T) +
labs(x = NULL, y = NULL, title = paste0('Akciók eloszlása ', Sys.Date())) +
scale_y_continuous(labels = percent_format(accuracy = 5L), breaks = seq(0, 1, 0.1), limits = c(0, 1)) +
theme_bw() +
theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust=1))
data %>% ggplot(aes(product_main_categories, abs(sale_rel), color = product_main_categories, fill = product_main_categories)) +
geom_boxplot(alpha = 0.5, show.legend = F, width = 1) +
labs(x = NULL, y = NULL, title = paste0('Akciók eloszlása ', Sys.Date())) +
scale_y_continuous(labels = percent_format(accuracy = 5L), breaks = seq(0, 1, 0.1), limits = c(0, 1)) +
theme_bw() +
theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust=1))
data %>% ggplot(aes(product_main_categories, abs(sale_rel), color = product_main_categories, fill = product_main_categories)) +
geom_boxplot(alpha = 0.5, show.legend = F, width = 1/3) +
labs(x = NULL, y = NULL, title = paste0('Akciók eloszlása ', Sys.Date())) +
scale_y_continuous(labels = percent_format(accuracy = 5L), breaks = seq(0, 1, 0.1), limits = c(0, 1)) +
theme_bw() +
theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust=1))
data %>% ggplot(aes(product_main_categories, abs(sale_rel), color = product_main_categories, fill = product_main_categories)) +
geom_boxplot(alpha = 0.5, show.legend = F, width = 1/2) +
labs(x = NULL, y = NULL, title = paste0('Akciók eloszlása ', Sys.Date())) +
scale_y_continuous(labels = percent_format(accuracy = 5L), breaks = seq(0, 1, 0.1), limits = c(0, 1)) +
theme_bw() +
theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust=1))
data %>% ggplot(aes(reorder(product_main_categories, mean(sale_rel)), abs(sale_rel), color = product_main_categories, fill = product_main_categories)) +
geom_boxplot(alpha = 0.5, show.legend = F, width = 1/2) +
labs(x = NULL, y = NULL, title = paste0('Akciók eloszlása ', Sys.Date())) +
scale_y_continuous(labels = percent_format(accuracy = 5L), breaks = seq(0, 1, 0.1), limits = c(0, 1)) +
theme_bw() +
theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust=1))
data %>% ggplot(aes(reorder(product_main_categories, abs(sale_rel)), abs(sale_rel), color = product_main_categories, fill = product_main_categories)) +
geom_boxplot(alpha = 0.5, show.legend = F, width = 1/2) +
labs(x = NULL, y = NULL, title = paste0('Akciók eloszlása ', Sys.Date())) +
scale_y_continuous(labels = percent_format(accuracy = 5L), breaks = seq(0, 1, 0.1), limits = c(0, 1)) +
theme_bw() +
theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust=1))
data %>% ggplot(aes(product_main_categories, abs(sale_rel), color = product_main_categories, fill = product_main_categories)) +
geom_boxplot(alpha = 0.5, show.legend = F, width = 1/2) +
labs(x = NULL, y = NULL, title = paste0('Akciók eloszlása ', Sys.Date())) +
scale_y_continuous(labels = percent_format(accuracy = 5L), breaks = seq(0, 1, 0.1), limits = c(0, 1)) +
theme_bw() +
theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust=1))
ggsave(paste0("charts/", Sys.Date(), "/on_sale_by_cat_distribution.png"))
data %>% ggplot(aes(product_main_categories, abs(sale_abs), color = product_main_categories, fill = product_main_categories)) +
geom_boxplot(alpha = 0.5, show.legend = F, width = 1/2) +
labs(x = NULL, y = NULL, title = paste0('Akciók eloszlása ', Sys.Date())) +
scale_y_continuous(labels = percent_format(accuracy = 5L), breaks = seq(0, 1, 0.1), limits = c(0, 1)) +
theme_bw() +
theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust=1))
data %>% ggplot(aes(product_main_categories, abs(sale_abs), color = product_main_categories, fill = product_main_categories)) +
geom_boxplot(alpha = 0.5, show.legend = F, width = 1/2) +
labs(x = NULL, y = NULL, title = paste0('Akciók eloszlása ', Sys.Date())) +
theme_bw() +
theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust=1))
data %>% ggplot(aes(product_main_categories, product_prices, color = product_main_categories, fill = product_main_categories)) +
geom_boxplot(alpha = 0.5, show.legend = F, width = 1/2) +
labs(x = NULL, y = NULL, title = paste0('Akciók eloszlása ', Sys.Date())) +
theme_bw() +
theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust=1))
data %>% ggplot(aes(product_main_categories, product_prices, color = product_main_categories, fill = product_main_categories)) +
geom_boxplot(alpha = 0.5, show.legend = F, width = 1/2) +
labs(x = NULL, y = NULL, title = paste0('Akciók eloszlása ', Sys.Date())) +
scale_y_continuous() +
theme_bw() +
theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust=1))
data %>% ggplot(aes(product_main_categories, product_prices, color = product_main_categories, fill = product_main_categories)) +
geom_boxplot(alpha = 0.5, show.legend = F, width = 1/2) +
labs(x = NULL, y = NULL, title = paste0('Akciók eloszlása ', Sys.Date())) +
scale_y_continuous(limits = c(0, 1000000)) +
theme_bw() +
theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust=1))
data %>% ggplot(aes(product_main_categories, product_prices, color = product_main_categories, fill = product_main_categories)) +
geom_boxplot(alpha = 0.5, show.legend = F, width = 1/2) +
labs(x = NULL, y = NULL, title = paste0('Akciók eloszlása ', Sys.Date())) +
scale_y_continuous(limits = c(0, 100000)) +
theme_bw() +
theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust=1))
data %>% ggplot(aes(product_main_categories, product_prices, color = product_main_categories, fill = product_main_categories)) +
geom_boxplot(alpha = 0.5, show.legend = F, width = 1/2) +
labs(x = NULL, y = NULL, title = paste0('Akciók eloszlása ', Sys.Date())) +
scale_y_continuous(label = comma, limits = c(0, 100000)) +
theme_bw() +
theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust=1))
data %>% ggplot(aes(product_prices, fill = product_main_categories)) +
geom_histogram(alpha = 0.5, show.legend = F) +
labs(x = NULL, y = NULL, title = paste0('Akciók eloszlása ', Sys.Date())) +
scale_y_continuous(label = comma, limits = c(0, 100000)) +
theme_bw() +
theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust=1))
data %>% ggplot(aes(product_prices, fill = product_main_categories)) +
geom_histogram(alpha = 0.5, show.legend = F) +
labs(x = NULL, y = NULL, title = paste0('Akciók eloszlása ', Sys.Date())) +
scale_y_continuous(label = comma, limits = c(0, 100000)) +
theme_bw() +
theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust=1)) +
facet_wrap(~product_main_categories) +
data %>% ggplot(aes(product_prices, fill = product_main_categories)) +
geom_histogram(alpha = 0.5, show.legend = F) +
labs(x = NULL, y = NULL, title = paste0('Akciók eloszlása ', Sys.Date())) +
scale_y_continuous(label = comma, limits = c(0, 100000)) +
theme_bw() +
theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust=1)) +
facet_wrap(~product_main_categories)
data %>% ggplot(aes(product_prices, fill = product_main_categories)) +
geom_histogram(alpha = 0.5, show.legend = F) +
labs(x = NULL, y = NULL, title = paste0('Akciók eloszlása ', Sys.Date())) +
scale_y_continuous(label = comma, limits = c(0, 100000)) +
theme_bw() +
theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust=1)) +
facet_wrap(~product_main_categories)
data %>% ggplot(aes(product_prices, fill = product_main_categories)) +
geom_histogram(alpha = 0.5, show.legend = F) +
labs(x = NULL, y = NULL, title = paste0('Akciók eloszlása ', Sys.Date())) +
scale_y_continuous(label = comma) +
theme_bw() +
theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust=1)) +
facet_wrap(~product_main_categories)
data %>% ggplot(aes(product_prices, fill = product_main_categories)) +
geom_histogram(alpha = 0.5, show.legend = F) +
labs(x = NULL, y = NULL, title = paste0('Akciók eloszlása ', Sys.Date())) +
scale_y_continuous(label = comma) +
scale_x_continuous(label = comma) +
theme_bw() +
theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust=1)) +
facet_wrap(~product_main_categories)
data %>% ggplot(aes(product_prices, fill = product_main_categories)) +
geom_histogram(alpha = 0.5, show.legend = F) +
labs(x = NULL, y = NULL, title = paste0('Akciók eloszlása ', Sys.Date())) +
scale_y_continuous(label = comma) +
scale_x_continuous(label = comma) +
theme_bw() +
theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust=1)) +
facet_wrap(~product_main_categories, scales = 'free')
data %>% ggplot(aes(product_prices, fill = product_main_categories)) +
geom_histogram(alpha = 0.5, show.legend = F) +
labs(x = NULL, y = NULL, title = paste0('Árak eloszlása ', Sys.Date())) +
scale_y_continuous(label = comma) +
scale_x_continuous(label = comma) +
theme_bw() +
theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust=1)) +
facet_wrap(~product_main_categories, scales = 'free')
data %>% ggplot(aes(product_prices)) +
geom_histogram(show.legend = F) +
labs(x = NULL, y = NULL, title = paste0('Árak eloszlása ', Sys.Date())) +
scale_y_continuous(label = comma) +
scale_x_continuous(label = comma) +
theme_bw() +
theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust=1)) +
facet_wrap(~product_main_categories, scales = 'free')
data %>% ggplot(aes(product_prices)) +
geom_histogram(show.legend = F) +
labs(x = NULL, y = NULL, title = paste0('Árak eloszlása ', Sys.Date())) +
scale_y_continuous(label = comma) +
scale_x_continuous(label = comma, limits = c(0, 500000)) +
theme_bw() +
theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust=1)) +
facet_wrap(~product_main_categories, scales = 'free')
data %>% ggplot(aes(product_prices)) +
geom_histogram(show.legend = F) +
labs(x = NULL, y = NULL, title = paste0('Árak eloszlása ', Sys.Date())) +
scale_y_continuous(label = comma) +
scale_x_continuous(label = comma, limits = c(0, 250000)) +
theme_bw() +
theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust=1)) +
facet_wrap(~product_main_categories, scales = 'free')
ggsave(paste0("charts/", Sys.Date(), "/prices_by_cat_distribution.png"))
data %>% group_by(sale_flag) %>% summarize(count = n()) %>% mutate(sale_flag = ifelse(is.na(sale_flag), 0, 1), count_pct = count / sum(count)) %>%
ggplot(aes(sale_flag, count)) +
geom_col() +
geom_text(aes(label = scales::percent(count_pct)), position = position_dodge(width = 1), vjust = -0.5) +
scale_x_continuous(breaks = c(0, 1)) +
scale_y_continuous() +
labs(title = paste0('Akciós termékek aránya ', Sys.Date()),
x = 'Akciós', y = 'Db') +
theme_bw()
ggsave(paste0("charts/", Sys.Date(), "/on_sale.png"))
data %>% group_by(product_main_categories, sale_flag) %>% summarize(count = n()) %>% mutate(sale_flag = ifelse(is.na(sale_flag), 0, 1), count_pct = count / sum(count)) %>%
ggplot(aes(sale_flag, count_pct)) +
geom_col() +
geom_text(aes(label = scales::percent(round(count_pct, digits = 3))), position = position_dodge(width = 1.5), vjust = -1/3) +
scale_x_continuous(breaks = c(0, 1)) +
scale_y_continuous(labels = percent_format(accuracy = 5L), breaks = seq(0, 1, 0.1), limits = c(0, 1)) +
facet_wrap(~product_main_categories) +
labs(title = paste0('Akciós termékek aránya ', Sys.Date()),
x = NULL, y = NULL) +
theme_bw()
ggsave(paste0("charts/", Sys.Date(), "/on_sale_by_cat.png"))
data %>% ggplot(aes(product_main_categories, abs(sale_rel), color = product_main_categories, fill = product_main_categories)) +
geom_boxplot(alpha = 0.5, show.legend = F, width = 1/2) +
labs(x = NULL, y = NULL, title = paste0('Akciók eloszlása ', Sys.Date())) +
scale_y_continuous(labels = percent_format(accuracy = 5L), breaks = seq(0, 1, 0.1), limits = c(0, 1)) +
theme_bw() +
theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust=1))
ggsave(paste0("charts/", Sys.Date(), "/on_sale_by_cat_distribution.png"))
data %>% ggplot(aes(product_prices)) +
geom_histogram(show.legend = F) +
labs(x = NULL, y = NULL, title = paste0('Árak eloszlása ', Sys.Date())) +
scale_y_continuous(label = comma) +
scale_x_continuous(label = comma, limits = c(0, 250000)) +
theme_bw() +
theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust=1)) +
facet_wrap(~product_main_categories, scales = 'free')
ggsave(paste0("charts/", Sys.Date(), "/prices_by_cat_distribution.png"))
library(tidyverse)
View(data)
mf <- data
mf$product_secondary_categories <- NULL
View(mf)
mf$sale_abs <- NULL
mf$sale_flag <- NULL
mf$sale_rel <- NULL
mf %>% rename(paste0('price_current_', Sys.Date()) = product_prices,
paste0('price_old_', Sys.Date()) = product_prices_old)
paste0('price_current_', Sys.Date())
rename_price_new <- paste0('price_current_', Sys.Date())
rename_price_old <- paste0('price_old_', Sys.Date())
mf %>% rename(rename_price_new = product_prices,
rename_price_old = product_prices_old)
mf %>% rename(get(rename_price_new) = product_prices,
rename_price_old = product_prices_old)
rename_price_new
rename_price_old
mf %>% rename(price_current_2020-07-16 = product_prices,
price_old_2020-07-16 = product_prices_old)
mf %>% rename("price_current_2020-07-16" = product_prices,
"price_old_2020-07-16" = product_prices_old)
mf <- mf %>% rename("price_current_2020-07-16" = product_prices,
"price_old_2020-07-16" = product_prices_old)
View(mf)
saveRDS(mf, "data/masterfile.RDS")
mf <- readRDS("data/masterfile.RDS")
data <- readRDS(paste0("data/data_products_", Sys.Date(), ".RDS"))
to_drop <- c("product_secondary_categories", "sale_abs", "sale_flag", "sale_rel")
data[to_drop]
data[to_drop,]
data[,to_drop]
data(to_drop)
data.table(data)
data.table(data)[to_drop]
data.table(data)[,to_drop]
data.table(data)[,..to_drop]
data[..to_drop]
data[,..to_drop]
data[,..to_drop] <- NULL
data[,..to_drop := NULL]
data.table(data)[,..to_drop := NULL]
data.table(data)[,..to_drop]
data <- data.table(data)
data[, to_drop]
data[, ..to_drop]
data[, ..to_drop := NULL]
data[, to_drop := NULL]
library(data.table)
data[, to_drop := NULL]
data[, .to_drop := NULL]
data[, .(to_drop) := NULL]
data[, .(to_drop := NULL)]
data[, to_drop := NULL]
data[, (to_drop) := NULL]
data
names(data)
names(data)[4]
names(data)[5]
names(data)[5] <- paste0('price_current_', Sys.Date())
names(data)[6]
names(data)[6] <- paste0('price_old_', Sys.Date())
data
Sys.Date(1)
paste0('price_current_', Sys.Date() + 1)
names(data)[5] <- paste0('price_current_', Sys.Date() + 1)
names(data)[6] <- paste0('price_old_', Sys.Date() + 1)
merge(mf, data, by = c("product_codes"))
merge(mf, data, by = c("product_codes"), all.x = T)
merge(mf, data, by = c("product_codes", "product_names"), all.x = T)
merge(mf, data, by = c("product_codes", "product_names", "product_main_categories"), all.x = T)
mf
merge(mf, data, by = c("product_codes", "product_names", "product_main_categories"), all.x = T)
merge(mf, data, by = c("product_codes", "product_names", "product_main_categories", "product_sub_categories"), all.x = T)
mf <- merge(mf, data, by = c("product_codes", "product_names", "product_main_categories", "product_sub_categories"), all.x = T)
saveRDS("data/masterfile.RDS")
saveRDS(mf, "data/masterfile.RDS")
mf <- readRDS("data/masterfile.RDS")
mf
mf$product_sub_categories
str_replace(mf$product_sub_categories, " \\(.*\\)", "")
trimws(str_replace(mf$product_sub_categories, " \\(.*\\)", ""))
mf$product_sub_categories <- trimws(str_replace(mf$product_sub_categories, " \\(.*\\)", ""))
mf <- readRDS("data/masterfile.RDS")
data <- readRDS(paste0("data/data_products_", Sys.Date(), ".RDS"))
to_drop <- c("product_secondary_categories", "sale_abs", "sale_flag", "sale_rel")
data <- data.table(data)
data[, (to_drop) := NULL]
names(data)[5] <- paste0('price_current_', Sys.Date())
names(data)[6] <- paste0('price_old_', Sys.Date())
merge(mf, data, by = c("product_codes", "product_names", "product_main_categories", "product_sub_categories"), all.x = T)
mf
mf$product_sub_categories <- trimws(str_replace(mf$product_sub_categories, " \\(.*\\)", ""))
mf
merge(mf, data, by = c("product_codes", "product_names", "product_main_categories", "product_sub_categories"), all.x = T)
data
data$product_sub_categories <- trimws(str_replace(data$product_sub_categories, " \\(.*\\)", ""))
data
merge(mf, data, by = c("product_codes", "product_names", "product_main_categories", "product_sub_categories"), all.x = T)
mf <- readRDS("data/masterfile.RDS")
mf
mf$product_sub_categories <- trimws(str_replace(mf$product_sub_categories, " \\(.*\\)", ""))
saveRDS(mf, "data/masterfile.RDS")
mf <- readRDS("data/masterfile.RDS")
mf
mf$`price_old_2020-07-17` <- NULL
mf$`price_current_2020-07-17` <- NULL
saveRDS(mf, "data/masterfile.RDS")
mf <- readRDS("data/masterfile.RDS")
mf
data <- readRDS(paste0("data/data_products_", Sys.Date(), ".RDS"))
to_drop <- c("product_secondary_categories", "sale_abs", "sale_flag", "sale_rel")
data <- data.table(data)
data[, (to_drop) := NULL]
names(data)[5] <- paste0('price_current_', Sys.Date())
names(data)[6] <- paste0('price_old_', Sys.Date())
merge(mf, data, by = c("product_codes", "product_names", "product_main_categories", "product_sub_categories"), all.x = T)
data
data <- readRDS(paste0("data/data_products_", Sys.Date(), ".RDS"))
data$product_sub_categories <- trimws(str_replace(data$product_sub_categories, " \\(.*\\)", ""))
data
saveRDS(data, paste0("data/data_products_", Sys.Date(), ".RDS"))
mf <- readRDS("data/masterfile.RDS")
data <- readRDS(paste0("data/data_products_", Sys.Date(), ".RDS"))
to_drop <- c("product_secondary_categories", "sale_abs", "sale_flag", "sale_rel")
data <- data.table(data)
data[, (to_drop) := NULL]
names(data)[5] <- paste0('price_current_', Sys.Date())
names(data)[6] <- paste0('price_old_', Sys.Date())
merge(mf, data, by = c("product_codes", "product_names", "product_main_categories", "product_sub_categories"), all.x = T)
