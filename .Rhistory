links[10]
links[10]
links[10]
ww <- links[10]
ww <- paste0(ww, "?searchParams=&sort=&view=PRODUCTLIST&page=")
read_html(ww) %>%
html_nodes(".pagination a")
read_html(ww) %>%
html_nodes(".hellip+ li a")
read_html(ww) %>%
html_nodes(".hellip+ li a") %>%
html_text()
read_html(ww) %>%
html_node(".hellip+ li a") %>%
html_text()
read_html(ww) %>%
html_node(".hellip+ li a") %>%
html_text() %>%
as.numeric()
last_page <-read_html(ww) %>%
html_node(".hellip+ li a") %>%
html_text() %>%
as.numeric()
ww <- links[10]
last_page <-read_html(ww) %>%
html_node(".hellip+ li a") %>%
html_text() %>%
as.numeric()
ww <- links[10]
last_page <- read_html(ww) %>%
html_node(".hellip+ li a") %>%
html_text() %>%
as.numeric()
read_html(ww)
ww
ww <- paste0(ww, "?searchParams=&sort=&view=PRODUCTLIST&page=")
ww
last_page <- read_html('https://www.mediamarkt.hu/hu/category/_nyomtat%C3%B3-scanner-504821.html') %>%
html_node(".hellip+ li a") %>%
html_text() %>%
as.numeric()
paste0(ww, 1:last_page)
ww <- paste0(ww, 1:last_page)
ww[8]
ww <- ww[8]
read_html(ww) %>%
html_nodes("h2 a")
read_html(ww) %>%
html_nodes("h2 a") %>%
html_text()
read_html(ww) %>%
html_nodes("h2 a") %>%
html_text(trim = T)
read_html(ww) %>%
html_nodes(".printonly") %>%
html_text(trim = T)
read_html(ww) %>%
html_nodes(".printonly") %>%
html_text(trim = T) %>%
str_remove_all("Cikkszám: ")
product_names <- read_html(ww) %>% html_nodes("h2 a") %>% html_text(trim = T)
product_codes <- read_html(ww) %>% html_nodes(".printonly") %>% html_text(trim = T) %>% str_remove_all("Cikkszám: ")
read_html(ww) %>% html_nodes(".small")
read_html(ww) %>% html_nodes(".small") %>% html_text()
product_prices <- read_html(ww) %>% html_nodes(".small") %>% html_text()
read_html(ww) %>% html_nodes(".large") %>% html_text()
read_html(ww) %>% html_nodes(".price-old") %>% html_text()
read_html(ww) %>% html_nodes(".price-old")
read_html(ww) %>% html_nodes(".alt")
read_html(ww) %>% html_nodes(".alt")
read_html(ww) %>% html_nodes(".alt > .small")
read_html(ww) %>% html_nodes(".alt") %>% html_nodes(".small")
read_html(ww) %>% html_nodes(".alt") %>% html_nodes(".price-old")
read_html(ww) %>% html_nodes(".alt") %>% html_text()
read_html(ww) %>% html_nodes(".alt") %>% html_text() %>% str_remove_all("\r\t\n")
read_html(ww) %>% html_nodes(".alt") %>% html_text() %>% str_remove_all("\\r\\t\\n")
read_html(ww) %>% html_nodes(".alt") %>% html_text() %>% str_remove_all("[\r\n\t]")
read_html(ww) %>% html_nodes(".alt") %>% html_text() %>% str_replace_all("[\r\n\t]", " ")
read_html(ww) %>% html_nodes(".alt") %>% html_text() %>% str_replace_all("[\r\n\t]", "")
read_html(ww) %>% html_nodes("//*[contains(concat( " ", @class, " " ), concat( " ", "price-old", " " ))]")
read_html(ww) %>% html_nodes('//*[contains(concat( " ", @class, " " ), concat( " ", "price-old", " " ))]')
read_html(ww) %>% html_nodes(xpath = '//*[contains(concat( " ", @class, " " ), concat( " ", "price-old", " " ))]')
read_html(ww) %>% html_nodes('.infobox)
read_html(ww) %>% html_nodes('.infobox')
read_html(ww) %>% html_nodes('.infobox')
read_html(ww) %>% html_nodes('.infobox') %>% html_nodes(".price small")
read_html(ww) %>% html_nodes('.infobox') %>% html_nodes(".small")
read_html(ww) %>% html_nodes('.infobox') %>% html_nodes(".price-old")
read_html(ww) %>% html_nodes('.infobox') %>% html_nodes(".price-old)
read_html(ww) %>% html_nodes('.infobox') %>% html_nodes(".price-old")
read_html(ww) %>% html_nodes('.infobox') %>% html_nodes(".price-old")
read_html(ww) %>% html_nodes('.infobox') %>% html_node(".price-old")
read_html(ww) %>% html_nodes('.infobox') %>% html_node(".price-old") %>% View()
read_html(ww) %>% html_nodes('.infobox') %>% html_node(".price-old") %>% html_text()
read_html(ww) %>% html_node(".price-old") %>% html_text()
read_html(ww) %>% html_nodes('.infobox') %>% html_node(".small") %>% html_text()
read_html(ww) %>% html_nodes('.infobox') %>% html_node(".price-old") %>% html_text()
read_html(ww) %>% html_nodes('.infobox') %>% html_node(".price-old") %>% html_text() %>% str_replace_all("[\r\n\t]", "")
product_prices
product_prices <- read_html(ww) %>% html_nodes(".small") %>% html_text() %>% as.numeric()
product_prices
read_html(ww) %>% html_nodes('.infobox') %>% html_node(".price-old") %>% html_text() %>% str_replace_all("[\r\n\t]", "") %>% as.numeric()
product_prices_old <- read_html(ww) %>% html_nodes('.infobox') %>% html_node(".price-old") %>% html_text() %>% str_replace_all("[\r\n\t]", "") %>% as.numeric()
product_prices_old[c(T, F)]
product_prices_old <- product_prices_old[c(T, F)]
data.frame(product_names = product_names,
product_codes = product_codes,
product_prices = product_prices,
product_prices_old = product_prices_old)
data.frame(product_names = product_names,
product_codes = product_codes,
product_prices = product_prices,
product_prices_old = product_prices_old,
sale_flag = ifelse((product_prices_old != "NA") &
(product_prices_old != product_prices),
1,
0))
data.frame(product_names = product_names,
product_codes = product_codes,
product_prices = product_prices,
product_prices_old = product_prices_old,
sale_flag = ifelse((product_prices_old != "NA") &
(product_prices_old != product_prices),
1,0))
data.frame(product_names = product_names,
product_codes = product_codes,
product_prices = product_prices,
product_prices_old = product_prices_old,
sale_flag = ifelse(((product_prices_old != "NA") & (product_prices_old != product_prices)),1,0))
data.frame(product_names = product_names,
product_codes = product_codes,
product_prices = product_prices,
product_prices_old = product_prices_old,
sale_flag = as.numeric(ifelse(((product_prices_old != "NA") & (product_prices_old != product_prices)),1,0)))
data.frame(product_names = product_names,
product_codes = product_codes,
product_prices = product_prices,
product_prices_old = product_prices_old,
sale_flag = ifelse(((product_prices_old != "NA") & (product_prices_old != product_prices)),1,0))
data <- data.frame(product_names = product_names,
product_codes = product_codes,
product_prices = product_prices,
product_prices_old = product_prices_old,
sale_flag = ifelse(((product_prices_old != "NA") & (product_prices_old != product_prices)),1,0))
extract_product_data <- function(x) {
read_page <- read_html(x)
product_names <- read_page %>% html_nodes("h2 a") %>% html_text(trim = T)
product_codes <- read_page %>% html_nodes(".printonly") %>% html_text(trim = T) %>% str_remove_all("Cikkszám: ")
product_prices <- read_page %>% html_nodes(".small") %>% html_text() %>% as.numeric()
product_prices_old <- read_page %>% html_nodes('.infobox') %>% html_node(".price-old") %>% html_text() %>% str_replace_all("[\r\n\t]", "") %>% as.numeric()
product_prices_old <- product_prices_old[c(T, F)]
data <- data.frame(product_names = product_names,
product_codes = product_codes,
product_prices = product_prices,
product_prices_old = product_prices_old,
sale_flag = ifelse(((product_prices_old != "NA") & (product_prices_old != product_prices)),1,0))
}
ww <- links[10]
ww <- paste0(ww, "?searchParams=&sort=&view=PRODUCTLIST&page=")
last_page <- read_html(ww) %>%
html_node(".hellip+ li a") %>%
html_text() %>%
as.numeric()
ww <- paste0(ww, 1:last_page)
ww
data <- rbindlist(pblapply(ww, extract_product_data))
data
links[1:3]
links[1]
links[1]$V1
rbindlist(pblapply(links[1:3], function(link) {
last_page <- read_html(link$V1) %>% html_node(".hellip+ li a") %>% html_text() %>% as.numeric()
all_links_to_scrape <- paste0(link$V1, "?searchParams=&sort=&view=PRODUCTLIST&page=", 1:last_page)
return(list(all_links_to_scrape))
}))
links[1]
links[1][1]
links[1][[1]]
rbindlist(pblapply(links[1:3], function(link) {
last_page <- read_html(link[[1]]) %>% html_node(".hellip+ li a") %>% html_text() %>% as.numeric()
all_links_to_scrape <- paste0(link$[[1]], "?searchParams=&sort=&view=PRODUCTLIST&page=", 1:last_page)
return(list(all_links_to_scrape))
}))
rbindlist(pblapply(links[1:3], function(link) {
last_page <- read_html(link[[1]]) %>% html_node(".hellip+ li a") %>% html_text() %>% as.numeric()
all_links_to_scrape <- paste0(link[[1]], "?searchParams=&sort=&view=PRODUCTLIST&page=", 1:last_page)
return(list(all_links_to_scrape))
}))
links[2]
links[2][[1]]
rbindlist(pblapply(links[2:3], function(link) {
last_page <- read_html(link[[1]]) %>% html_node(".hellip+ li a") %>% html_text() %>% as.numeric()
all_links_to_scrape <- paste0(link[[1]], "?searchParams=&sort=&view=PRODUCTLIST&page=", 1:last_page)
return(list(all_links_to_scrape))
}))
rbindlist(pblapply(links[3], function(link) {
last_page <- read_html(link[[1]]) %>% html_node(".hellip+ li a") %>% html_text() %>% as.numeric()
all_links_to_scrape <- paste0(link[[1]], "?searchParams=&sort=&view=PRODUCTLIST&page=", 1:last_page)
return(list(all_links_to_scrape))
}))
links[3][[1]]
last_page <- read_html(links[3][[1]]) %>% html_node(".hellip+ li a") %>% html_text() %>% as.numeric()
last_page
rbindlist(pblapply(links[3], function(link) {
last_page <- read_html(link[[1]]) %>% html_node(".hellip+ li a") %>% html_text() %>% as.numeric()
if (is.na(last_page)) {
all_links_to_scrape <- paste0(link[[1]], "?searchParams=&sort=&view=PRODUCTLIST&page=", 1:4)
} else {
all_links_to_scrape <- paste0(link[[1]], "?searchParams=&sort=&view=PRODUCTLIST&page=", 1:last_page)
}
return(list(all_links_to_scrape))
}))
pblapply(links[3], function(link) {
last_page <- read_html(link[[1]]) %>% html_node(".hellip+ li a") %>% html_text() %>% as.numeric()
if (is.na(last_page)) {
all_links_to_scrape <- paste0(link[[1]], "?searchParams=&sort=&view=PRODUCTLIST&page=", 1:4)
} else {
all_links_to_scrape <- paste0(link[[1]], "?searchParams=&sort=&view=PRODUCTLIST&page=", 1:last_page)
}
return(list(all_links_to_scrape))
})
rbindlist(pblapply(links[1:3], function(link) {
last_page <- read_html(link[[1]]) %>% html_node(".hellip+ li a") %>% html_text() %>% as.numeric()
if (is.na(last_page)) {
all_links_to_scrape <- paste0(link[[1]], "?searchParams=&sort=&view=PRODUCTLIST&page=", 1:4)
} else {
all_links_to_scrape <- paste0(link[[1]], "?searchParams=&sort=&view=PRODUCTLIST&page=", 1:last_page)
}
return(list(all_links_to_scrape))
}))
links[1:3]
unlist(links[1:3])
list(links[1:3])
links[1:3][[1]]
rbindlist(pblapply(links[1:3][[1]], function(link) {
last_page <- read_html(link[[1]]) %>% html_node(".hellip+ li a") %>% html_text() %>% as.numeric()
if (is.na(last_page)) {
all_links_to_scrape <- paste0(link[[1]], "?searchParams=&sort=&view=PRODUCTLIST&page=", 1:4)
} else {
all_links_to_scrape <- paste0(link[[1]], "?searchParams=&sort=&view=PRODUCTLIST&page=", 1:last_page)
}
return(list(all_links_to_scrape))
}))
main_link <- "https://www.mediamarkt.hu/?ref=logo_rh"
main_categories_link <- read_html(main_link) %>%
html_nodes(".ms-row__column:nth-child(3) .ms-link") %>%
html_attr("href") %>%
str_replace_all("//", "https://")
read_sub_category_links <- function(x) {
return(list(read_html(x) %>%
html_nodes(".categories-flat-descendants a") %>%
html_attr("href") %>%
str_replace_all("/hu/cat", "https://www.mediamarkt.hu/hu/cat")))
}
sub_categories_links <- rbindlist(pblapply(main_categories_link, read_sub_category_links))
sub_categories_links
saveRDS(sub_categories_links, "data/links_categories.RDS")
rm(main_link, main_categories_link, sub_categories_links)
links <- readRDS("data/links_categories.RDS")
products_links <- rbindlist(pblapply(links[[1]], function(link) {
last_page <- read_html(link[[1]]) %>% html_node(".hellip+ li a") %>% html_text() %>% as.numeric()
if (is.na(last_page)) {
all_links_to_scrape <- paste0(link[[1]], "?searchParams=&sort=&view=PRODUCTLIST&page=", 1:4)
} else {
all_links_to_scrape <- paste0(link[[1]], "?searchParams=&sort=&view=PRODUCTLIST&page=", 1:last_page)
}
return(list(all_links_to_scrape))
}))
products_links
saveRDS(products_links, "data/links_products.RDS")
extract_product_data <- function(x) {
read_page <- read_html(x)
product_names <- read_page %>% html_nodes("h2 a") %>% html_text(trim = T)
product_codes <- read_page %>% html_nodes(".printonly") %>% html_text(trim = T) %>% str_remove_all("Cikkszám: ")
product_prices <- read_page %>% html_nodes(".small") %>% html_text() %>% as.numeric()
product_prices_old <- read_page %>% html_nodes('.infobox') %>% html_node(".price-old") %>% html_text() %>% str_replace_all("[\r\n\t]", "") %>% as.numeric()
product_prices_old <- product_prices_old[c(T, F)]
data <- data.frame(product_names = product_names,
product_codes = product_codes,
product_prices = product_prices,
product_prices_old = product_prices_old,
sale_flag = ifelse(((product_prices_old != "NA") & (product_prices_old != product_prices)),1,0))
}
products_links[[1]]
products_links[1:5][[1]]
data <- rbindlist(pblapply(products_links[1:5][[1]], extract_product_data))
View(data)
saveRDS("data/data_products.RDS", data)
saveRDS(data, "data/data_products.RDS")
data <- rbindlist(pblapply(products_links[[1]], extract_product_data))
data <- rbindlist(pblapply(products_links[1:50][[1]], extract_product_data))
View(data)
data <- rbindlist(pblapply(products_links[50:100][[1]], extract_product_data))
data <- rbindlist(pblapply(products_links[55:65][[1]], extract_product_data))
data <- rbindlist(pblapply(products_links[60:65][[1]], extract_product_data))
products_links[60:65]
data <- rbindlist(pblapply(products_links[60:61][[1]], extract_product_data))
data <- rbindlist(pblapply(products_links[62:65][[1]], extract_product_data))
read_html("https://www.mediamarkt.hu/hu/category/_2in1-%C3%A1talak%C3%ADthat%C3%B3-eszk%C3%B6z-563570.html?searchParams=&sort=&view=PRODUCTLIST&page=4")
read_html("https://www.mediamarkt.hu/hu/category/_2in1-%C3%A1talak%C3%ADthat%C3%B3-eszk%C3%B6z-563570.html?searchParams=&sort=&view=PRODUCTLIST&page=4") %>%
html_nodes("h2 a")
read_html("https://www.mediamarkt.hu/hu/category/_2in1-%C3%A1talak%C3%ADthat%C3%B3-eszk%C3%B6z-563570.html?searchParams=&sort=&view=PRODUCTLIST&page=4") %>%
html_nodes("h2 a") == "{xml_nodeset (0)}"
read_html("https://www.mediamarkt.hu/hu/category/_2in1-%C3%A1talak%C3%ADthat%C3%B3-eszk%C3%B6z-563570.html?searchParams=&sort=&view=PRODUCTLIST&page=4") %>%
html_nodes("h2 a") %>% html_text()
is.na(read_html("https://www.mediamarkt.hu/hu/category/_2in1-%C3%A1talak%C3%ADthat%C3%B3-eszk%C3%B6z-563570.html?searchParams=&sort=&view=PRODUCTLIST&page=4") %>%
html_nodes("h2 a"))
read_html("https://www.mediamarkt.hu/hu/category/_2in1-%C3%A1talak%C3%ADthat%C3%B3-eszk%C3%B6z-563570.html?searchParams=&sort=&view=PRODUCTLIST&page=4") %>%
html_node("h2 a")
read_html("https://www.mediamarkt.hu/hu/category/_2in1-%C3%A1talak%C3%ADthat%C3%B3-eszk%C3%B6z-563570.html?searchParams=&sort=&view=PRODUCTLIST&page=4") %>%
html_nodes("h2 a")
typeof(read_html("https://www.mediamarkt.hu/hu/category/_2in1-%C3%A1talak%C3%ADthat%C3%B3-eszk%C3%B6z-563570.html?searchParams=&sort=&view=PRODUCTLIST&page=4") %>%
html_nodes("h2 a"))
class(read_html("https://www.mediamarkt.hu/hu/category/_2in1-%C3%A1talak%C3%ADthat%C3%B3-eszk%C3%B6z-563570.html?searchParams=&sort=&view=PRODUCTLIST&page=4") %>%
html_nodes("h2 a"))
read_html("https://www.mediamarkt.hu/hu/category/_2in1-%C3%A1talak%C3%ADthat%C3%B3-eszk%C3%B6z-563570.html?searchParams=&sort=&view=PRODUCTLIST&page=4") %>%
html_nodes("h2 a") %>% html_text()
class(read_html("https://www.mediamarkt.hu/hu/category/_2in1-%C3%A1talak%C3%ADthat%C3%B3-eszk%C3%B6z-563570.html?searchParams=&sort=&view=PRODUCTLIST&page=4") %>%
html_nodes("h2 a") %>% html_text())
identical(read_html("https://www.mediamarkt.hu/hu/category/_2in1-%C3%A1talak%C3%ADthat%C3%B3-eszk%C3%B6z-563570.html?searchParams=&sort=&view=PRODUCTLIST&page=4") %>%
html_nodes("h2 a") %>% html_text(), character(0))
identical(read_html("https://www.mediamarkt.hu/hu/category/_2in1-%C3%A1talak%C3%ADthat%C3%B3-eszk%C3%B6z-563570.html?searchParams=&sort=&view=PRODUCTLIST&page=4") %>%
html_nodes("h2 a") %>% html_text(trim = T), character(0))
!identical(read_html("https://www.mediamarkt.hu/hu/category/_2in1-%C3%A1talak%C3%ADthat%C3%B3-eszk%C3%B6z-563570.html?searchParams=&sort=&view=PRODUCTLIST&page=4") %>%
html_nodes("h2 a") %>% html_text(trim = T), character(0))
extract_product_data <- function(x) {
read_page <- read_html(x)
product_names <- read_page %>% html_nodes("h2 a") %>% html_text(trim = T)
if (!identical(product_names, character(0))) {
product_codes <- read_page %>% html_nodes(".printonly") %>% html_text(trim = T) %>% str_remove_all("Cikkszám: ")
product_prices <- read_page %>% html_nodes(".small") %>% html_text() %>% as.numeric()
product_prices_old <- read_page %>% html_nodes('.infobox') %>% html_node(".price-old") %>% html_text() %>% str_replace_all("[\r\n\t]", "") %>% as.numeric()
product_prices_old <- product_prices_old[c(T, F)]
data <- data.frame(product_names = product_names,
product_codes = product_codes,
product_prices = product_prices,
product_prices_old = product_prices_old,
sale_flag = ifelse(((product_prices_old != "NA") & (product_prices_old != product_prices)),1,0))
}
}
data <- rbindlist(pblapply(products_links[62:65][[1]], extract_product_data))
View(data)
products_links[[1]]
data <- rbindlist(pblapply(products_links[[1]], extract_product_data))
3065*0.08
3065*0.1
data <- rbindlist(pblapply(products_links[240:306][[1]], extract_product_data))
data <- rbindlist(pblapply(products_links[290:306][[1]], extract_product_data))
data <- rbindlist(pblapply(products_links[295:306][[1]], extract_product_data))
data <- rbindlist(pblapply(products_links[298:306][[1]], extract_product_data))
data <- rbindlist(pblapply(products_links[300:306][[1]], extract_product_data))
data <- rbindlist(pblapply(products_links[299][[1]], extract_product_data))
data <- rbindlist(pblapply(products_links[300][[1]], extract_product_data))
products_links[300]
products_links[300:330]
products_links[300]
read_page <- read_html(products_links[300][[1]])
product_names <- read_page %>% html_nodes("h2 a") %>% html_text(trim = T)
product_names
product_codes <- read_page %>% html_nodes(".printonly") %>% html_text(trim = T) %>% str_remove_all("Cikkszám: ")
product_codes
product_prices <- read_page %>% html_nodes(".small") %>% html_text() %>% as.numeric()
product_prices
product_prices_old <- read_page %>% html_nodes('.infobox') %>% html_node(".price-old") %>% html_text() %>% str_replace_all("[\r\n\t]", "") %>% as.numeric()
product_prices_old <- product_prices_old[c(T, F)]
product_prices_old
data <- data.frame(product_names = product_names,
product_codes = product_codes,
product_prices = product_prices,
product_prices_old = product_prices_old,
sale_flag = ifelse(((product_prices_old != "NA") & (product_prices_old != product_prices)),1,0))
products_links[300]
data <- rbindlist(pblapply(products_links[290:310][[1]], extract_product_data))
data <- rbindlist(pblapply(products_links[297:310][[1]], extract_product_data))
data <- rbindlist(pblapply(products_links[295:297][[1]], extract_product_data))
data <- rbindlist(pblapply(products_links[290:310][[1]], extract_product_data))
data <- rbindlist(pblapply(products_links[295:305][[1]], extract_product_data))
data <- rbindlist(pblapply(products_links[297:305][[1]], extract_product_data))
data <- rbindlist(pblapply(products_links[298:305][[1]], extract_product_data))
data <- rbindlist(pblapply(products_links[297][[1]], extract_product_data))
data <- rbindlist(pblapply(products_links[296][[1]], extract_product_data))
data <- rbindlist(pblapply(products_links[298][[1]], extract_product_data))
data <- rbindlist(pblapply(products_links[290:310][[1]], extract_product_data))
products_links[290:310]
product_names
length(product_names)
length(product_prices)
length(product_prices)
length(product_prices_old)
extract_product_data <- function(x) {
read_page <- read_html(x)
product_names <- read_page %>% html_nodes("h2 a") %>% html_text(trim = T)
if (!identical(product_names, character(0))) {
product_codes <- read_page %>% html_nodes(".printonly") %>% html_text(trim = T) %>% str_remove_all("Cikkszám: ")
product_prices <- read_page %>% html_nodes(".small") %>% html_text() %>% as.numeric()
product_prices_old <- read_page %>% html_nodes('.infobox') %>% html_node(".price-old") %>% html_text() %>% str_replace_all("[\r\n\t]", "") %>% as.numeric()
product_prices_old <- product_prices_old[c(T, F)]
if (length(product_names) == length(product_prices)) {
data <- data.frame(product_names = product_names,
product_codes = product_codes,
product_prices = product_prices,
product_prices_old = product_prices_old,
sale_flag = ifelse(((product_prices_old != "NA") & (product_prices_old != product_prices)),1,0))
}
}
}
data <- rbindlist(pblapply(products_links[290:310][[1]], extract_product_data))
View(data)
data <- rbindlist(pblapply(products_links[[1]], extract_product_data))
data <- rbindlist(pblapply(products_links[1:300][[1]], extract_product_data))
View(data)
data$sale_abs <- data$product_prices_old - data$product_prices
data$product_prices / data$product_prices_old
(data$product_prices - data$product_prices_old) / data$product_prices_old
data$sale_rel <- (data$product_prices - data$product_prices_old) / data$product_prices_old
saveRDS(data, "data/data_products.RDS")
data[!duplicated(data), ]
data <- data[!duplicated(data), ]
View(data)
data$sale_abs <- data$product_prices - data$product_prices_old
data$sale_rel <- (data$product_prices - data$product_prices_old) / data$product_prices_old
View(data)
data %>%
ggplot(aes(sale_rel)) +
geom_density()
data %>%
ggplot(aes(sale_rel)) +
geom_density() +
theme_bw()
data %>%
ggplot(aes(abs(sale_rel))) +
geom_density() +
theme_bw()
data %>%
ggplot(aes(abs(sale_rel))) +
geom_histogram() +
theme_bw()
data %>%
ggplot(aes(abs(sale_rel))) +
geom_histogram(binwidth = 0.05) +
theme_bw()
data %>%
ggplot(aes(abs(sale_rel))) +
geom_histogram(binwidth = 0.001) +
theme_bw()
data %>%
ggplot(aes(abs(sale_rel))) +
geom_histogram(binwidth = 0.01) +
theme_bw()
data %>% group_by(sale_flag) %>% summarize(count = n())
data %>% group_by(sale_flag) %>% summarize(count = n()) %>% ggplot(aes(sale_flag, count)) + geom_col()
data %>% group_by(sale_flag) %>% summarize(count = n()) %>% ggplot(aes(sale_flag, count)) + geom_col() + scale_x_discrete()
mutate(sale_flag = ifelse(is.na(sale_flag), 0, 1) %>% ggplot(aes(sale_flag, count)) + geom_col() + scale_x_discrete()
data %>% group_by(sale_flag) %>% summarize(count = n()) %>%
mutate(sale_flag = ifelse(is.na(sale_flag), 0, 1)) %>% ggplot(aes(sale_flag, count)) + geom_col() + scale_x_discrete()
data %>% group_by(sale_flag) %>% summarize(count = n()) %>%
mutate(sale_flag = ifelse(is.na(sale_flag), 0, 1)) %>% ggplot(aes(sale_flag, count)) + geom_col() + scale_x_discrete()
data %>% group_by(sale_flag) %>% summarize(count = n()) %>%
mutate(sale_flag = ifelse(is.na(sale_flag), 0, 1)) %>% ggplot(aes(sale_flag, count)) + geom_col()
data %>% group_by(sale_flag) %>% summarize(count = n()) %>% mutate(sale_flag = ifelse(is.na(sale_flag), 0, 1)) %>%
ggplot(aes(sale_flag, count)) +
geom_col() +
scale_x_continuous(breaks = c(0, 1))
data %>% group_by(sale_flag) %>% summarize(count = n())
data %>% ggplot(aes(abs(sale_rel))) + geom_histogram(binwidth = 0.01) + theme_bw()
data %>% group_by(sale_flag) %>% summarize(count = n()) %>% mutate(sale_flag = ifelse(is.na(sale_flag), 0, 1),
count_pct = count / sum(count))
data %>% group_by(sale_flag) %>% summarize(count = n()) %>% mutate(sale_flag = ifelse(is.na(sale_flag), 0, 1),
count_pct = count / sum(count)) %>%
ggplot(aes(sale_flag, count)) +
geom_col() +
geom_text(aes(label = count_pct)) +
scale_x_continuous(breaks = c(0, 1))
data %>% group_by(sale_flag) %>% summarize(count = n()) %>% mutate(sale_flag = ifelse(is.na(sale_flag), 0, 1),
count_pct = count / sum(count)) %>%
ggplot(aes(sale_flag, count)) +
geom_col() +
geom_text(aes(label = count_pct), position = position_dodge(width = 1), vjust = -0.5, size = 2) +
scale_x_continuous(breaks = c(0, 1))
data %>% group_by(sale_flag) %>% summarize(count = n()) %>% mutate(sale_flag = ifelse(is.na(sale_flag), 0, 1),
count_pct = count / sum(count)) %>%
ggplot(aes(sale_flag, count)) +
geom_col() +
geom_text(aes(label = count_pct), position = position_dodge(width = 1), vjust = -0.5) +
scale_x_continuous(breaks = c(0, 1))
data %>% group_by(sale_flag) %>% summarize(count = n()) %>% mutate(sale_flag = ifelse(is.na(sale_flag), 0, 1),
count_pct = count / sum(count)) %>%
ggplot(aes(sale_flag, count)) +
geom_col() +
geom_text(aes(label = scales::percent(count_pct)), position = position_dodge(width = 1), vjust = -0.5) +
scale_x_continuous(breaks = c(0, 1))
data %>% group_by(sale_flag) %>% summarize(count = n()) %>% mutate(sale_flag = ifelse(is.na(sale_flag), 0, 1),
count_pct = count / sum(count)) %>%
ggplot(aes(sale_flag, count)) +
geom_col() +
geom_text(aes(label = scales::percent(count_pct)), position = position_dodge(width = 1), vjust = -0.5) +
scale_x_continuous(breaks = c(0, 1)) +
theme_bw()
data %>% group_by(sale_flag) %>% summarize(count = n()) %>% mutate(sale_flag = ifelse(is.na(sale_flag), 0, 1), count_pct = count / sum(count)) %>%
ggplot(aes(sale_flag, count)) +
geom_col() +
geom_text(aes(label = scales::percent(count_pct)), position = position_dodge(width = 1), vjust = -0.5) +
scale_x_continuous(breaks = c(0, 1)) +
theme_bw()
saveRDS(data, "data/data_products.RDS")
data %>% ggplot(aes(abs(sale_rel))) + geom_histogram(binwidth = 0.01) + theme_bw()
data %>% group_by(sale_flag) %>% summarize(count = n()) %>% mutate(sale_flag = ifelse(is.na(sale_flag), 0, 1), count_pct = count / sum(count)) %>%
ggplot(aes(sale_flag, count)) +
geom_col() +
geom_text(aes(label = scales::percent(count_pct)), position = position_dodge(width = 1), vjust = -0.5) +
scale_x_continuous(breaks = c(0, 1)) +
theme_bw()
